# コンセプト同期

Difyのコンセプトは、コンセプトからデータをインポートして **同期** を設定し、コンセプトが更新された後に自動的にデータを同期して更新することをサポートしています。

### 認証

1. ナレッジベースを作成する際に、データソースを選択し、**コンセプト同期--接続へ移動** をクリックし、指示に従って認証検証を完了してください。
2. また、**設定--データソース--データソースの追加** をクリックし、コンセプトソースの **接続** をクリックして認証を完了することもできます。

<figure><img src="../../.gitbook/assets/notion-connect.png" alt=""><figcaption><p>コンセプトリンク</p></figcaption></figure>

### データインポート

認証操作が完了したら、ナレッジベースの構築ページに移動し、**コンセプト同期** をクリックして、インポートする必要な認証ページを選択します。

### セグメンテーションクレンジング

次に、**セグメンテーション設定** と **インデックス方法** を選択し、**保存して処理** をクリックします。Difyがデータを処理するのを待ちます。このステップでは通常、LLMプロバイダーでトークンを使用する必要があります。一般的なページタイプのインポートだけでなく、データベースタイプのページ属性も集計して保存できます。

_**注: 現在、画像やファイルのインポートはサポートしていません。表データはテキストに変換されます。**_

### コンセプトデータの同期

コンセプト内容が変更された場合、Difyのナレッジドキュメントリストページで[同期]ボタンをクリックしてデータを一括で同期できます（注意: 各クリックで現在の内容が同期されます）。このステップでもトークンの使用が必要です。

<figure><img src="../../.gitbook/assets/sync-notion-data.png" alt=""><figcaption><p>コンセプトデータの同期</p></figcaption></figure>

### (コミュニティ版) コンセプト統合設定ガイド

統合は **内部統合** と **公共統合** の2つの方法があります。これらは必要に応じてDifyで設定できます。

これら2つの統合方法の具体的な違いについては、[コンセプト公式説明](https://developers.notion.com/docs/authorization) を参照してください。

#### 1. **内部統合を使用**

あなたの統合ページを [統合設定](https://www.notion.so/my-integrations) で作成します。デフォルトでは、すべての統合は内部統合から始まります。内部統合は選択したワークスペースに関連付けられるため、ワークスペースの所有者である必要があります。

**具体的な操作手順:**

" **New integration** " ボタンをクリックすると、デフォルトで内部（変更不可）となります。関連するスペースを選択し、名前を入力してロゴをアップロードし、"**提出**" をクリックして統合を成功させます。

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

統合が作成されると、必要に応じて設定を更新できます。 **性能** タブを選択し、 **シークレットキー** を表示するために "**表示**" ボタンをクリックしてシークレットキーをコピーします。

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

それをコピーしてDifyのソースコードに戻り、関連する環境変数を **.env** ファイルに設定します。環境変数は以下の通りです：

**NOTION\_INTEGRATION\_TYPE** = 内部 または **NOTION\_INTEGRATION\_TYPE** = 公共

**NOTION\_INTERNAL\_SECRET**= あなたの内部シークレットキー

#### 2. **公共統合を使用**

**内部統合を公共統合にアップグレードする必要があります**。統合配布ページに移動し、統合を表示するためにスイッチを切り替えます。

スイッチを公共設定に切り替えるには、**組織情報に追加情報を入力** する必要があります。会社名、ウェブサイト、およびリダイレクト目標パスを含む追加情報を入力してから、 "提出" ボタンをクリックします。

<figure><img src="../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

公共統合が成功した後、[統合設定ページ](https://www.notion.so/my-integrations) で、[シークレットキー] タブにアクセスして統合のシークレットキーを確認できます。

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

Difyのソースコードに戻り、関連する環境変数を **.env** ファイルに設定します。環境変数は以下の通りです：

**NOTION\_INTEGRATION\_TYPE**=公共

**NOTION\_CLIENT\_SECRET**=あなたのクライアントシークレットキー

**NOTION\_CLIENT\_ID**=あなたのクライアントID

設定が完了すると、ナレッジセクション内のコンセプトデータのインポートおよび同期機能を使用できるようになります。